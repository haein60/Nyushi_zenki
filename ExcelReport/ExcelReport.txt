ExcelReport説明


概要
　このプログラムはエクセルのテンプレートファイルを読込み、記述されているＳＱＬ文で
　ＤＢのデータをシートに書き込むプログラムです。


インストール
　セットアップファイルを実行してください。
　テンプレートファイルを実行ファイル(ExcelReport.exe)の直下にある"Template"ディレクトリ
　に入れてください。　このディレクトリの".xls"ファイルがテンプレート選択リストに並びます。


操作方法
　テンプレートファイル名が列挙されますので選択して"OK"ボタンを押してください。
　出力ファイルは実行ファイルと同じディレクトリ上に"Output.xls"で保存されます。
　出力後このファイルを開く形でエクセルが起動します。
　ファイルを保存したい場合は、別名にして保存してください。



テンプレート説明
　シート名"Command"のシートに記述されているコマンドを上から順次実行し
　結果を"Sheet"コマンドで指定したシートに書き込みます。
　コマンドの実行後シート名"Command"のシートを除去したエクセルファイルを出力します。

コマンドの書き方
　コマンドはシートの１列目に、対応する引数は２列目以降に記述します。
　（以降の説明では各列をカンマで切って表します）
　コマンド欄が空白の行で処理を終わります。
　先頭が"["で始まる行はコメントと見なされます。

セル位置の指定
　セル位置の指定は、(列、行)形式と、(A1)形式の両方が使用出来ます。
　例：CELL(1,1), SQL(A1)

引数
　コマンドの引数に変数を含める場合は、変数名を"#"で囲んで指定します。
　"#Cell(位置指定)#"を含む場合は"Sheet"コマンドで指定したシートのセル値に置換されます。
  変数名は大文字小文字を区別しません。
　
　例：SQL(A1), SELECT sTelNo from tbList where vName = #Name#
　　　　"#Name#"が変数"Name"の値に置換されます。　変数は予め定義しておく必要が有ります。
　　　CELL(B1), #CELL(A1)#
　　　　"#CELL(A1)#"がシートの"A1"セルの値に置換されます。



コマンド説明

ＯＤＢＣ接続コマンド
宣言
　Odbc, Dsn, UserID, Password
説明
　データベースに接続します。


変数追加、値変更コマンド
宣言
　Let, 変数名, 値
説明
　変数に値を代入します。　すでに同名の変数がある場合は上書きされます。
　同名の変数が無い場合は変数が追加されます。
　変数名は大文字、小文字を識別しません。


シート指定コマンド
宣言
　Sheet, シート名
説明
　操作対象となるシートを指定します。
　また、次回ファイルを開いた時に表示されるシートは最後に指定したシートになります。


SQLコマンド
宣言
　Sql(位置指定), ＳＱＬ文
説明
　ＳＱＬを発行し返されたテーブルを指定位置から書き込みます。


セル書き込みコマンド
宣言
　Cell(位置指定), 値
説明
　値を指定位置に書き込みます。


メッセージ表示
宣言
　MsgBox, 値
説明
　メッセージボックスを表示します。


ダイアログ初期化
宣言
　DialogInit
説明
　ダイアログを初期化します。
　必ず"DialogShow"とペアで使用してください。
　入力する項目を追加コマンドで追加します。


ダイアログ表示
宣言
　DialogShow
説明
　ダイアログを表示します。
　必ず"DialogInit"とペアで使用してください。


タイトル設定
宣言
　Title, 値
説明
　ダイアログのタイトルを設定します。


ラベル追加
宣言
　Label, 値
説明
　ダイアログにラベルを追加します。


テキストボックス追加
宣言
　Text, 変数, 初期値
説明
　ダイアログにテキストボックスを追加します。
　入力された値は変数に格納されます。


パスワードテキストボックス追加
宣言
　TextPassword, 変数, 初期値
説明
　ダイアログにパスワードテキストボックスを追加します。
　入力文字は"*"で表示されます。
　入力された値は変数に格納されます。


日付入力追加
宣言
　Date, 変数, [初期値]
説明
　ダイアログに日付入力を追加します。
　初期値が省略された場合は現在の日付が入ります。
　入力された値は変数に格納されます。


コンボボックス追加
宣言1:固定データリストの場合
　ComboBox, 変数, 選択1, 選択2, 選択3, ・・・空白欄まで
宣言2:DBデータリストの場合
　ComboBox, 変数, <SQL>, [SQL文字列], [0:必須,1:空白項目追加(指定無し)]
	SQL文字列の戻り列の書式:<文字列データ>
　　　または
	SQL文字列の戻り列の書式:<表示文字列データ>,<ID列(数値型)>

説明
　ダイアログにコンボボックスを追加します。
　入力された値は変数に格納されます。(ID列使用時はID列データが格納される)

